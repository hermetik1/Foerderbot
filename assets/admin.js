/*! For license information please see admin.js.LICENSE.txt */
(()=>{"use strict";var e={20:(e,t,n)=>{var a=n(594),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var a,s={},c=null,d=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,a)&&!l.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===s[a]&&(s[a]=t[a]);return{$$typeof:r,type:e,key:c,ref:d,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var s={},i=[],o=0;o<e.length;o++){var l=e[o],c=a.base?l[0]+a.base:l[0],d=s[c]||0,p="".concat(c," ").concat(d);s[c]=d+1;var u=n(p),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)t[u].references++,t[u].updater(h);else{var x=r(h,a);a.byIndex=o,t.splice(o,0,{identifier:p,updater:x,references:1})}i.push(p)}return i}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=a(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<s.length;i++){var o=n(s[i]);t[o].references--}for(var l=a(e,r),c=0;c<s.length;c++){var d=n(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=l}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},206:e=>{e.exports=ReactDOM},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,a,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(a)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(i[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);a&&i[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},338:(e,t,n)=>{var a=n(206);t.H=a.createRoot,a.hydrateRoot},409:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(601),r=n.n(a),s=n(314),i=n.n(s)()(r());i.push([e.id,'/* KI Kraft Admin Styles */\n\n:root {\n\t--kk-primary: #3b82f6;\n\t--kk-primary-contrast: #ffffff;\n\t--kk-surface: #ffffff;\n\t--kk-surface-2: #f8fafc;\n\t--kk-border: #e5e7eb;\n\t--kk-text: #111827;\n\t--kk-text-muted: #6b7280;\n\t--kk-focus: 0 0 0 3px rgba(59, 130, 246, 0.35);\n\t--kk-success: #10b981;\n\t--kk-warning: #f59e0b;\n\t--kk-error: #ef4444;\n}\n\n* {\n\tbox-sizing: border-box;\n}\n\n.ki-kraft-dashboard {\n\tpadding: 0;\n\tmax-width: 100%;\n\tmargin: 0;\n\tbackground: #f0f0f1;\n}\n\n.dashboard-nav {\n\tbackground: var(--kk-surface);\n\tborder-bottom: 1px solid var(--kk-border);\n\tpadding: 12px 20px;\n\tdisplay: flex;\n\tgap: 8px;\n\tflex-wrap: wrap;\n}\n\n.dashboard-nav button {\n\tpadding: 8px 16px;\n\tbackground: transparent;\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 6px;\n\tcursor: pointer;\n\tcolor: var(--kk-text);\n\tfont-size: 14px;\n\ttransition: all 0.2s;\n}\n\n.dashboard-nav button:hover {\n\tbackground: var(--kk-surface-2);\n}\n\n.dashboard-nav button.active {\n\tbackground: var(--kk-primary);\n\tcolor: var(--kk-primary-contrast);\n\tborder-color: var(--kk-primary);\n}\n\n.dashboard-content {\n\tpadding: 20px;\n}\n\n.dashboard-grid {\n\tdisplay: grid;\n\tgrid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n\tgap: 20px;\n\tmargin-top: 20px;\n}\n\n.dashboard-card {\n\tbackground: var(--kk-surface);\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 8px;\n\tpadding: 20px;\n\tbox-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.dashboard-card h2 {\n\tmargin-top: 0;\n\tcolor: var(--kk-text);\n\tfont-size: 18px;\n\tborder-bottom: 1px solid var(--kk-border);\n\tpadding-bottom: 10px;\n\tmargin-bottom: 15px;\n}\n\n.stats-grid {\n\tdisplay: grid;\n\tgrid-template-columns: repeat(2, 1fr);\n\tgap: 15px;\n}\n\n.stat {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 5px;\n}\n\n.stat-label {\n\tfont-size: 12px;\n\tcolor: var(--kk-text-muted);\n\ttext-transform: uppercase;\n\tletter-spacing: 0.5px;\n}\n\n.stat-value {\n\tfont-size: 28px;\n\tfont-weight: bold;\n\tcolor: var(--kk-text);\n}\n\n.stat-value.success {\n\tcolor: var(--kk-success);\n}\n\n.stat-value.warning {\n\tcolor: var(--kk-warning);\n}\n\n.action-buttons {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 10px;\n}\n\n.action-btn {\n\tpadding: 12px 16px;\n\tbackground: var(--kk-surface-2);\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 6px;\n\tcursor: pointer;\n\ttext-align: left;\n\ttransition: all 0.2s;\n\tfont-size: 14px;\n}\n\n.action-btn:hover {\n\tbackground: var(--kk-primary);\n\tcolor: var(--kk-primary-contrast);\n\tborder-color: var(--kk-primary);\n}\n\n.settings-tab {\n\tbackground: var(--kk-surface);\n\tborder-radius: 8px;\n\tpadding: 20px;\n\tbox-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.settings-tab h2 {\n\tmargin-top: 0;\n\tcolor: var(--kk-text);\n\tborder-bottom: 2px solid var(--kk-primary);\n\tpadding-bottom: 10px;\n\tmargin-bottom: 20px;\n}\n\n.form-group {\n\tmargin-bottom: 20px;\n}\n\n.form-group label {\n\tdisplay: block;\n\tmargin-bottom: 5px;\n\tfont-weight: 500;\n\tcolor: var(--kk-text);\n}\n\n.form-group input[type="text"],\n.form-group input[type="url"],\n.form-group textarea,\n.form-group select {\n\twidth: 100%;\n\tpadding: 8px 12px;\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 4px;\n\tfont-size: 14px;\n}\n\n.form-group textarea {\n\tresize: vertical;\n\tfont-family: inherit;\n}\n\n.form-group .description {\n\tmargin-top: 5px;\n\tfont-size: 12px;\n\tcolor: var(--kk-text-muted);\n}\n\n.color-input {\n\tdisplay: flex;\n\tgap: 10px;\n}\n\n.color-input input[type="color"] {\n\twidth: 60px;\n\theight: 38px;\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 4px;\n\tcursor: pointer;\n}\n\n.color-input input[type="text"] {\n\tflex: 1;\n}\n\n.button {\n\tpadding: 8px 16px;\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 4px;\n\tbackground: var(--kk-surface);\n\tcursor: pointer;\n\tfont-size: 14px;\n}\n\n.button-primary {\n\tbackground: var(--kk-primary);\n\tcolor: var(--kk-primary-contrast);\n\tborder-color: var(--kk-primary);\n}\n\n.button-primary:hover:not(:disabled) {\n\tfilter: brightness(0.95);\n}\n\n.button-primary:disabled {\n\topacity: 0.6;\n\tcursor: not-allowed;\n}\n\n.notice {\n\tpadding: 12px 16px;\n\tborder-left: 4px solid;\n\tmargin-bottom: 20px;\n\tborder-radius: 4px;\n}\n\n.notice-success {\n\tbackground: #f0fdf4;\n\tborder-color: var(--kk-success);\n\tcolor: #166534;\n}\n\n.notice-error {\n\tbackground: #fef2f2;\n\tborder-color: var(--kk-error);\n\tcolor: #991b1b;\n}\n\n.notice-warning {\n\tbackground: #fffbeb;\n\tborder-color: var(--kk-warning);\n\tcolor: #92400e;\n}\n\n.notice-info {\n\tbackground: #eff6ff;\n\tborder-color: var(--kk-primary);\n\tcolor: #1e40af;\n}\n\n.knowledge-table, .analytics-table {\n\twidth: 100%;\n\tborder-collapse: collapse;\n\tmargin-top: 15px;\n}\n\n.knowledge-table th,\n.knowledge-table td,\n.analytics-table th,\n.analytics-table td {\n\tpadding: 10px;\n\ttext-align: left;\n\tborder-bottom: 1px solid var(--kk-border);\n}\n\n.knowledge-table th,\n.analytics-table th {\n\tbackground: var(--kk-surface-2);\n\tfont-weight: 600;\n\tcolor: var(--kk-text);\n}\n\n.scope-badge {\n\tdisplay: inline-block;\n\tpadding: 3px 8px;\n\tborder-radius: 12px;\n\tfont-size: 11px;\n\tfont-weight: 500;\n\ttext-transform: uppercase;\n}\n\n.scope-public {\n\tbackground: #dbeafe;\n\tcolor: #1e40af;\n}\n\n.scope-members {\n\tbackground: #fef3c7;\n\tcolor: #92400e;\n}\n\n.analytics-grid {\n\tdisplay: grid;\n\tgrid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n\tgap: 20px;\n\tmargin-top: 20px;\n}\n\n.analytics-card {\n\tbackground: var(--kk-surface);\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 8px;\n\tpadding: 20px;\n}\n\n.analytics-card.full-width {\n\tgrid-column: 1 / -1;\n}\n\n.analytics-card h3 {\n\tmargin-top: 0;\n\tfont-size: 16px;\n\tcolor: var(--kk-text);\n\tborder-bottom: 1px solid var(--kk-border);\n\tpadding-bottom: 10px;\n\tmargin-bottom: 15px;\n}\n\n.trend-chart {\n\tdisplay: flex;\n\tgap: 8px;\n\talign-items: flex-end;\n\theight: 200px;\n\tpadding-top: 20px;\n}\n\n.trend-bar-container {\n\tflex: 1;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\theight: 100%;\n}\n\n.trend-bar {\n\twidth: 100%;\n\tbackground: var(--kk-primary);\n\tborder-radius: 4px 4px 0 0;\n\tmin-height: 4px;\n\ttransition: all 0.3s;\n}\n\n.trend-bar:hover {\n\tfilter: brightness(1.1);\n}\n\n.trend-label {\n\tfont-size: 10px;\n\tcolor: var(--kk-text-muted);\n\tmargin-top: 5px;\n\twriting-mode: horizontal-tb;\n}\n\n.period-selector {\n\tmargin-bottom: 20px;\n}\n\n.period-selector label {\n\tfont-weight: 500;\n\tmargin-right: 10px;\n}\n\n.period-selector select {\n\tpadding: 6px 12px;\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 4px;\n}\n\n.no-data {\n\ttext-align: center;\n\tcolor: var(--kk-text-muted);\n\tpadding: 20px;\n\tfont-style: italic;\n}\n\n.preview {\n\tmargin-top: 10px;\n\tpadding: 10px;\n\tbackground: var(--kk-surface-2);\n\tborder-radius: 4px;\n}\n\n.form-section {\n\tmargin-bottom: 30px;\n\tpadding-bottom: 20px;\n\tborder-bottom: 1px solid var(--kk-border);\n}\n\n.form-section:last-child {\n\tborder-bottom: none;\n}\n\n.form-section h3 {\n\tmargin-top: 0;\n\tmargin-bottom: 15px;\n\tcolor: var(--kk-text);\n\tfont-size: 16px;\n}\n\n.form-actions {\n\tmargin-top: 20px;\n\tpadding-top: 20px;\n\tborder-top: 1px solid var(--kk-border);\n}\n\n/* Settings Page Styles */\n.ki-kraft-settings-page {\n\tpadding: 0;\n\tmax-width: 100%;\n\tmargin: 0;\n\tbackground: #f0f0f1;\n}\n\n.settings-header {\n\tbackground: var(--kk-surface);\n\tborder-bottom: 1px solid var(--kk-border);\n\tpadding: 20px;\n}\n\n.settings-header h1 {\n\tmargin: 0 0 8px 0;\n\tfont-size: 24px;\n\tcolor: var(--kk-text);\n}\n\n.settings-header p {\n\tmargin: 0;\n\tcolor: var(--kk-text-muted);\n\tfont-size: 14px;\n}\n\n.settings-search {\n\tpadding: 15px 20px;\n\tbackground: var(--kk-surface);\n\tborder-bottom: 1px solid var(--kk-border);\n}\n\n.settings-search-input {\n\twidth: 100%;\n\tmax-width: 400px;\n\tpadding: 8px 12px;\n\tborder: 1px solid var(--kk-border);\n\tborder-radius: 6px;\n\tfont-size: 14px;\n}\n\n.settings-search-input:focus {\n\toutline: none;\n\tbox-shadow: var(--kk-focus);\n\tborder-color: var(--kk-primary);\n}\n\n.settings-layout {\n\tdisplay: flex;\n\tmin-height: calc(100vh - 200px);\n}\n\n.settings-sidebar {\n\twidth: 240px;\n\tbackground: var(--kk-surface);\n\tborder-right: 1px solid var(--kk-border);\n\tpadding: 20px 10px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 4px;\n}\n\n.settings-sidebar button {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 12px;\n\tpadding: 12px 16px;\n\tbackground: transparent;\n\tborder: none;\n\tborder-radius: 6px;\n\tcursor: pointer;\n\tcolor: var(--kk-text);\n\tfont-size: 14px;\n\ttext-align: left;\n\ttransition: all 0.2s;\n\twidth: 100%;\n}\n\n.settings-sidebar button:hover {\n\tbackground: var(--kk-surface-2);\n}\n\n.settings-sidebar button.active {\n\tbackground: var(--kk-primary);\n\tcolor: var(--kk-primary-contrast);\n\tfont-weight: 500;\n}\n\n.settings-sidebar button .icon {\n\tfont-size: 18px;\n}\n\n.settings-sidebar button .label {\n\tflex: 1;\n}\n\n.settings-content {\n\tflex: 1;\n\tpadding: 20px;\n\toverflow-y: auto;\n}\n\n.settings-footer {\n\tbackground: var(--kk-surface);\n\tborder-top: 1px solid var(--kk-border);\n\tpadding: 20px;\n}\n\n.disclaimer {\n\tmax-width: 900px;\n\tmargin: 0 auto;\n}\n\n.disclaimer h3 {\n\tmargin-top: 0;\n\tfont-size: 16px;\n\tcolor: var(--kk-text);\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 8px;\n}\n\n.disclaimer p {\n\tfont-size: 13px;\n\tcolor: var(--kk-text-muted);\n\tline-height: 1.6;\n\tmargin-bottom: 10px;\n}\n\n.disclaimer a {\n\tcolor: var(--kk-primary);\n\ttext-decoration: none;\n}\n\n.disclaimer a:hover {\n\ttext-decoration: underline;\n}\n\n@media (max-width: 768px) {\n\t.settings-layout {\n\t\tflex-direction: column;\n\t}\n\t\n\t.settings-sidebar {\n\t\twidth: 100%;\n\t\tborder-right: none;\n\t\tborder-bottom: 1px solid var(--kk-border);\n\t\tpadding: 10px;\n\t}\n\t\n\t.settings-sidebar button {\n\t\tpadding: 10px 12px;\n\t}\n}\n',""]);const o=i},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},594:e=>{e.exports=React},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},848:(e,t,n)=>{e.exports=n(20)}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={id:a,exports:{}};return e[a](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var a=n(848),r=n(594),s=n.n(r),i=n(338);async function o(e,t={}){const n=`${kraftAIChatAdmin.apiUrl}${e}`,a={"Content-Type":"application/json","X-WP-Nonce":kraftAIChatAdmin.nonce,...t.headers};try{const e=await fetch(n,{...t,headers:a}),r=await e.json();if(!e.ok)throw{code:r.code||"unknown_error",message:r.message||"An error occurred",data:r.data||{status:e.status}};return r}catch(e){if(e.code)throw e;throw{code:"network_error",message:"Network error occurred",data:{status:0}}}}const l=async e=>o(`/settings/${e}`),c=async(e,t)=>o(`/settings/${e}`,{method:"POST",body:JSON.stringify(t)}),d=async(e=7)=>o(`/analytics/summary?days=${e}`),p=async(e=50)=>o(`/knowledge?limit=${e}`),u=async e=>o("/knowledge",{method:"POST",body:JSON.stringify(e)}),h=async e=>o(`/knowledge/${e}`,{method:"DELETE"}),x=()=>{const[e,t]=(0,r.useState)({retention_enabled:!0,retention_days:365,external_ai_enabled:!1,consent_required:!0,data_export_enabled:!0,data_erase_enabled:!0,collect_local_analytics:!1}),[n,s]=(0,r.useState)(!0),[i,o]=(0,r.useState)(!1),[d,p]=(0,r.useState)(""),[u,h]=(0,r.useState)({});(0,r.useEffect)(()=>{x()},[]);const x=async()=>{try{const e=await l("privacy");t(e)}catch(e){console.error("Failed to load settings:",e),p("Failed to load settings.")}finally{s(!1)}};return n?(0,a.jsx)("div",{className:"settings-tab privacy-tab",children:(0,a.jsx)("p",{children:"Loading settings..."})}):(0,a.jsxs)("div",{className:"settings-tab privacy-tab",children:[(0,a.jsx)("h2",{children:"Privacy & GDPR Settings"}),(0,a.jsx)("p",{children:"Configure data protection and GDPR compliance settings."}),d&&(0,a.jsx)("div",{className:"notice "+(d.includes("successfully")?"notice-success":"notice-error"),role:"status","aria-live":"polite",children:(0,a.jsx)("p",{children:d})}),(0,a.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),o(!0),p(""),h({});try{(await c("privacy",e)).success&&p("Privacy settings saved successfully!")}catch(e){const t=e;t.data?.errors?(h(t.data.errors),p("Validation failed. Please check the fields below.")):p(t.message||"Error saving settings.")}finally{o(!1)}},children:[(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"Data Retention"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"retention_enabled",children:[(0,a.jsx)("input",{type:"checkbox",id:"retention_enabled",checked:e.retention_enabled,onChange:n=>t({...e,retention_enabled:n.target.checked})})," ","Enable Automatic Data Retention"]}),(0,a.jsx)("p",{className:"description",children:"Automatically delete old data after specified period"})]}),e.retention_enabled&&(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"retention_days",children:"Retention Period (days)"}),(0,a.jsx)("input",{type:"number",id:"retention_days",value:e.retention_days,onChange:n=>t({...e,retention_days:Number(n.target.value)}),min:"30",max:"3650","aria-describedby":"retention_days_desc"}),(0,a.jsx)("p",{className:"description",id:"retention_days_desc",children:"Data older than this will be automatically deleted (default: 365 days)"}),u.retention_days&&(0,a.jsx)("p",{className:"error-text",children:u.retention_days})]})]}),(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"External AI Services"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"external_ai_enabled",children:[(0,a.jsx)("input",{type:"checkbox",id:"external_ai_enabled",checked:e.external_ai_enabled,onChange:n=>t({...e,external_ai_enabled:n.target.checked})})," ","Enable External AI Services"]}),(0,a.jsx)("p",{className:"description",children:"Use external AI services (e.g., OpenAI) for embeddings and completions"})]}),e.external_ai_enabled&&(0,a.jsx)("div",{className:"notice notice-warning",role:"alert",children:(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Privacy Notice:"})," When enabled, user queries may be sent to external AI services. Ensure users are informed and consent is obtained as required by GDPR."]})}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"consent_required",children:[(0,a.jsx)("input",{type:"checkbox",id:"consent_required",checked:e.consent_required,onChange:n=>t({...e,consent_required:n.target.checked})})," ","Require User Consent"]}),(0,a.jsx)("p",{className:"description",children:"Show consent notice before using external AI services"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"collect_local_analytics",children:[(0,a.jsx)("input",{type:"checkbox",id:"collect_local_analytics",checked:e.collect_local_analytics,onChange:n=>t({...e,collect_local_analytics:n.target.checked})})," ","Collect Local Analytics"]}),(0,a.jsx)("p",{className:"description",children:"Track queries and interactions locally (no external tracking)"})]})]}),(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"GDPR Rights"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"data_export_enabled",children:[(0,a.jsx)("input",{type:"checkbox",id:"data_export_enabled",checked:e.data_export_enabled,onChange:n=>t({...e,data_export_enabled:n.target.checked})})," ","Enable Data Export (Right to Access)"]}),(0,a.jsx)("p",{className:"description",children:"Allow users to export their data via WordPress privacy tools"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"data_erase_enabled",children:[(0,a.jsx)("input",{type:"checkbox",id:"data_erase_enabled",checked:e.data_erase_enabled,onChange:n=>t({...e,data_erase_enabled:n.target.checked})})," ","Enable Data Erasure (Right to be Forgotten)"]}),(0,a.jsx)("p",{className:"description",children:"Allow users to request deletion of their data via WordPress privacy tools"})]}),(0,a.jsx)("div",{className:"notice notice-info",role:"status",children:(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Info:"})," Users can request data export/erasure via WordPress â†’ Settings â†’ Privacy â†’ Export/Erase Personal Data"]})})]}),(0,a.jsx)("div",{className:"form-actions",children:(0,a.jsx)("button",{type:"submit",className:"button button-primary",disabled:i||n,children:i?"Saving...":"Save Privacy Settings"})})]})]})},m=()=>{const[e,t]=(0,r.useState)({logo_url:"",product_name:"KI Kraft",primary_color:"#3b82f6",secondary_color:"#60a5fa",favicon_url:"",footer_text:"",privacy_url:"",imprint_url:"",powered_by:!0}),[n,s]=(0,r.useState)(!0),[i,o]=(0,r.useState)(!1),[d,p]=(0,r.useState)(""),[u,h]=(0,r.useState)({});(0,r.useEffect)(()=>{x()},[]);const x=async()=>{try{const e=await l("branding");t(e)}catch(e){console.error("Failed to load settings:",e),p("Failed to load settings.")}finally{s(!1)}};return n?(0,a.jsx)("div",{className:"settings-tab whitelabel-tab",children:(0,a.jsx)("p",{children:"Loading settings..."})}):(0,a.jsxs)("div",{className:"settings-tab whitelabel-tab",children:[(0,a.jsx)("h2",{children:"White-Label Branding"}),(0,a.jsx)("p",{children:"Customize the appearance and branding of the KI Kraft plugin."}),d&&(0,a.jsx)("div",{className:"notice "+(d.includes("successfully")?"notice-success":"notice-error"),role:"status","aria-live":"polite",children:(0,a.jsx)("p",{children:d})}),(0,a.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),o(!0),p(""),h({});try{(await c("branding",e)).success&&(p("Branding settings saved successfully!"),document.documentElement.style.setProperty("--kraft-primary-color",e.primary_color),document.documentElement.style.setProperty("--kraft-secondary-color",e.secondary_color))}catch(e){const t=e;t.data?.errors?(h(t.data.errors),p("Validation failed. Please check the fields below.")):p(t.message||"Error saving settings.")}finally{o(!1)}},className:"branding-form",children:[(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"Visual Identity"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"product_name",children:"Product Name"}),(0,a.jsx)("input",{type:"text",id:"product_name",value:e.product_name,onChange:n=>t({...e,product_name:n.target.value}),"aria-describedby":"product_name_desc"}),(0,a.jsx)("p",{className:"description",id:"product_name_desc",children:"The name displayed in the plugin interface"}),u.product_name&&(0,a.jsx)("p",{className:"error-text",children:u.product_name})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"logo_url",children:"Logo URL"}),(0,a.jsx)("input",{type:"url",id:"logo_url",value:e.logo_url,onChange:n=>t({...e,logo_url:n.target.value}),placeholder:"https://example.com/logo.png","aria-describedby":"logo_url_desc"}),(0,a.jsx)("p",{className:"description",id:"logo_url_desc",children:"URL to your custom logo image"}),u.logo_url&&(0,a.jsx)("p",{className:"error-text",children:u.logo_url}),e.logo_url&&(0,a.jsx)("div",{className:"preview",children:(0,a.jsx)("img",{src:e.logo_url,alt:"Logo preview",style:{maxHeight:"60px"}})})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"primary_color",children:"Primary Color"}),(0,a.jsxs)("div",{className:"color-input",children:[(0,a.jsx)("input",{type:"color",id:"primary_color",value:e.primary_color,onChange:n=>t({...e,primary_color:n.target.value}),"aria-describedby":"primary_color_desc"}),(0,a.jsx)("input",{type:"text",value:e.primary_color,onChange:n=>t({...e,primary_color:n.target.value}),placeholder:"#3b82f6",pattern:"^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$"})]}),(0,a.jsx)("p",{className:"description",id:"primary_color_desc",children:"Main brand color (hex format)"}),u.primary_color&&(0,a.jsx)("p",{className:"error-text",children:u.primary_color})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"secondary_color",children:"Secondary Color"}),(0,a.jsxs)("div",{className:"color-input",children:[(0,a.jsx)("input",{type:"color",id:"secondary_color",value:e.secondary_color,onChange:n=>t({...e,secondary_color:n.target.value}),"aria-describedby":"secondary_color_desc"}),(0,a.jsx)("input",{type:"text",value:e.secondary_color,onChange:n=>t({...e,secondary_color:n.target.value}),placeholder:"#60a5fa",pattern:"^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$"})]}),(0,a.jsx)("p",{className:"description",id:"secondary_color_desc",children:"Secondary brand color (hex format)"}),u.secondary_color&&(0,a.jsx)("p",{className:"error-text",children:u.secondary_color})]})]}),(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"Footer & Legal"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"footer_text",children:"Footer Text"}),(0,a.jsx)("textarea",{id:"footer_text",value:e.footer_text,onChange:n=>t({...e,footer_text:n.target.value}),rows:3,"aria-describedby":"footer_text_desc"}),(0,a.jsx)("p",{className:"description",id:"footer_text_desc",children:"Custom footer text displayed in the chatbot"}),u.footer_text&&(0,a.jsx)("p",{className:"error-text",children:u.footer_text})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"privacy_url",children:"Privacy Policy URL"}),(0,a.jsx)("input",{type:"url",id:"privacy_url",value:e.privacy_url,onChange:n=>t({...e,privacy_url:n.target.value}),placeholder:"https://example.com/privacy","aria-describedby":"privacy_url_desc"}),(0,a.jsx)("p",{className:"description",id:"privacy_url_desc",children:"Link to your privacy policy"}),u.privacy_url&&(0,a.jsx)("p",{className:"error-text",children:u.privacy_url})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"imprint_url",children:"Imprint URL"}),(0,a.jsx)("input",{type:"url",id:"imprint_url",value:e.imprint_url,onChange:n=>t({...e,imprint_url:n.target.value}),placeholder:"https://example.com/imprint","aria-describedby":"imprint_url_desc"}),(0,a.jsx)("p",{className:"description",id:"imprint_url_desc",children:"Link to your imprint page (required in Germany)"}),u.imprint_url&&(0,a.jsx)("p",{className:"error-text",children:u.imprint_url})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"favicon_url",children:"Favicon URL"}),(0,a.jsx)("input",{type:"url",id:"favicon_url",value:e.favicon_url,onChange:n=>t({...e,favicon_url:n.target.value}),placeholder:"https://example.com/favicon.ico","aria-describedby":"favicon_url_desc"}),(0,a.jsx)("p",{className:"description",id:"favicon_url_desc",children:"URL to your custom favicon"}),u.favicon_url&&(0,a.jsx)("p",{className:"error-text",children:u.favicon_url})]}),(0,a.jsx)("div",{className:"form-group",children:(0,a.jsxs)("label",{htmlFor:"powered_by",children:[(0,a.jsx)("input",{type:"checkbox",id:"powered_by",checked:e.powered_by,onChange:n=>t({...e,powered_by:n.target.checked})})," ",'Show "Powered by KI Kraft" attribution']})})]}),(0,a.jsx)("div",{className:"form-actions",children:(0,a.jsx)("button",{type:"submit",className:"button button-primary",disabled:i||n,children:i?"Saving...":"Save Branding Settings"})})]})]})},b=()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)({chunk_max_tokens:500,chunk_overlap:50,similarity_threshold:.7,max_results:5}),[i,o]=(0,r.useState)(!0),[d,x]=(0,r.useState)(!0),[m,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1),[v,y]=(0,r.useState)({title:"",content:"",scope:"public"}),[j,k]=(0,r.useState)(!1),[_,N]=(0,r.useState)(""),[w,S]=(0,r.useState)({});(0,r.useEffect)(()=>{A(),C()},[]);const C=async()=>{try{const e=await l("knowledge");s(e)}catch(e){console.error("Failed to load knowledge settings:",e)}finally{x(!1)}},A=async()=>{try{const e=await p(50);t(e.entries||[])}catch(e){console.error("Failed to fetch knowledge entries:",e)}finally{o(!1)}};return(0,a.jsxs)("div",{className:"settings-tab knowledge-tab",children:[(0,a.jsx)("h2",{children:"Knowledge Base Management"}),_&&(0,a.jsx)("div",{className:"notice "+(_.includes("successfully")?"notice-success":"notice-error"),role:"status","aria-live":"polite",children:(0,a.jsx)("p",{children:_})}),(0,a.jsxs)("div",{className:"knowledge-actions",children:[(0,a.jsx)("button",{onClick:()=>f(!g),className:"button",children:g?"Hide Settings":"âš™ï¸ Knowledge Base Settings"}),(0,a.jsx)("button",{onClick:()=>b(!m),className:"button button-primary",children:m?"Cancel":"+ Add New Entry"})]}),g&&!d&&(0,a.jsx)("form",{onSubmit:async e=>{e.preventDefault(),k(!0),N(""),S({});try{(await c("knowledge",n)).success&&(N("Knowledge base settings saved successfully!"),f(!1))}catch(e){const t=e;t.data?.errors?(S(t.data.errors),N("Validation failed. Please check the fields below.")):N(t.message||"Error saving settings.")}finally{k(!1)}},className:"knowledge-settings-form",style:{marginBottom:"20px",padding:"20px",background:"#f5f5f5",borderRadius:"4px"},children:(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"Chunking & Retrieval Settings"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"chunk_max_tokens",children:"Maximum Chunk Size (tokens)"}),(0,a.jsx)("input",{type:"number",id:"chunk_max_tokens",value:n.chunk_max_tokens,onChange:e=>s({...n,chunk_max_tokens:Number(e.target.value)}),min:"100",max:"2000","aria-describedby":"chunk_max_tokens_desc"}),(0,a.jsx)("p",{className:"description",id:"chunk_max_tokens_desc",children:"Maximum number of tokens per knowledge chunk (default: 500)"}),w.chunk_max_tokens&&(0,a.jsx)("p",{className:"error-text",children:w.chunk_max_tokens})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"chunk_overlap",children:"Chunk Overlap (tokens)"}),(0,a.jsx)("input",{type:"number",id:"chunk_overlap",value:n.chunk_overlap,onChange:e=>s({...n,chunk_overlap:Number(e.target.value)}),min:"0",max:"500","aria-describedby":"chunk_overlap_desc"}),(0,a.jsx)("p",{className:"description",id:"chunk_overlap_desc",children:"Number of overlapping tokens between chunks (default: 50)"}),w.chunk_overlap&&(0,a.jsx)("p",{className:"error-text",children:w.chunk_overlap})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"similarity_threshold",children:"Similarity Threshold"}),(0,a.jsx)("input",{type:"number",id:"similarity_threshold",value:n.similarity_threshold,onChange:e=>s({...n,similarity_threshold:Number(e.target.value)}),min:"0",max:"1",step:"0.1","aria-describedby":"similarity_threshold_desc"}),(0,a.jsx)("p",{className:"description",id:"similarity_threshold_desc",children:"Minimum similarity score to include results (0-1, default: 0.7)"}),w.similarity_threshold&&(0,a.jsx)("p",{className:"error-text",children:w.similarity_threshold})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"max_results",children:"Maximum Results"}),(0,a.jsx)("input",{type:"number",id:"max_results",value:n.max_results,onChange:e=>s({...n,max_results:Number(e.target.value)}),min:"1",max:"20","aria-describedby":"max_results_desc"}),(0,a.jsx)("p",{className:"description",id:"max_results_desc",children:"Maximum number of knowledge entries to return per query (default: 5)"}),w.max_results&&(0,a.jsx)("p",{className:"error-text",children:w.max_results})]}),(0,a.jsx)("div",{className:"form-actions",children:(0,a.jsx)("button",{type:"submit",className:"button button-primary",disabled:j,children:j?"Saving...":"Save Settings"})})]})}),m&&(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await u(v),y({title:"",content:"",scope:"public"}),b(!1),A()}catch(e){console.error("Failed to add entry:",e)}},className:"knowledge-form",children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Title"}),(0,a.jsx)("input",{type:"text",value:v.title,onChange:e=>y({...v,title:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Content"}),(0,a.jsx)("textarea",{value:v.content,onChange:e=>y({...v,content:e.target.value}),rows:10,required:!0})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Scope"}),(0,a.jsxs)("select",{value:v.scope,onChange:e=>y({...v,scope:e.target.value}),children:[(0,a.jsx)("option",{value:"public",children:"Public (FAQ Bot)"}),(0,a.jsx)("option",{value:"members",children:"Members Only"}),(0,a.jsx)("option",{value:"role:administrator",children:"Administrators"})]})]}),(0,a.jsx)("button",{type:"submit",className:"button button-primary",children:"Add Entry"})]}),i?(0,a.jsx)("p",{children:"Loading knowledge base..."}):(0,a.jsxs)("table",{className:"knowledge-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Title"}),(0,a.jsx)("th",{children:"Scope"}),(0,a.jsx)("th",{children:"Created"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{children:[(0,a.jsx)("strong",{children:e.title}),(0,a.jsx)("br",{}),(0,a.jsxs)("small",{children:[e.content.substring(0,100),"..."]})]}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:`scope-badge scope-${e.scope}`,children:e.scope})}),(0,a.jsx)("td",{children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsx)("td",{children:(0,a.jsx)("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this entry?"))try{await h(e),A()}catch(e){console.error("Failed to delete entry:",e)}})(e.id),className:"button button-small",children:"Delete"})})]},e.id))})]})]})},g=()=>{const[e,t]=(0,r.useState)(null),[n,s]=(0,r.useState)({enabled:!0,retention_days:90,anonymize_ip:!0,track_feedback:!0}),[i,o]=(0,r.useState)(!0),[p,u]=(0,r.useState)(!0),[h,x]=(0,r.useState)(!1),[m,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(7),[v,y]=(0,r.useState)(""),[j,k]=(0,r.useState)({});(0,r.useEffect)(()=>{N(),_()},[g]);const _=async()=>{try{const e=await l("analytics");s(e)}catch(e){console.error("Failed to load analytics settings:",e)}finally{u(!1)}},N=async()=>{o(!0);try{const e=await d(g);t(e)}catch(e){console.error("Failed to fetch analytics:",e)}finally{o(!1)}};if(i)return(0,a.jsx)("div",{className:"settings-tab analytics-tab",children:(0,a.jsx)("p",{children:"Loading analytics..."})});if(!e)return(0,a.jsx)("div",{className:"settings-tab analytics-tab",children:(0,a.jsx)("p",{children:"Failed to load analytics"})});const w=e.total>0?Math.round(e.answered/e.total*100):0;return(0,a.jsxs)("div",{className:"settings-tab analytics-tab",children:[(0,a.jsx)("h2",{children:"Analytics Dashboard"}),v&&(0,a.jsx)("div",{className:"notice "+(v.includes("successfully")?"notice-success":"notice-error"),role:"status","aria-live":"polite",children:(0,a.jsx)("p",{children:v})}),(0,a.jsxs)("div",{style:{marginBottom:"20px",display:"flex",gap:"10px",alignItems:"center"},children:[(0,a.jsx)("label",{children:"Period: "}),(0,a.jsxs)("select",{value:g,onChange:e=>f(Number(e.target.value)),children:[(0,a.jsx)("option",{value:7,children:"Last 7 Days"}),(0,a.jsx)("option",{value:30,children:"Last 30 Days"}),(0,a.jsx)("option",{value:90,children:"Last 90 Days"})]}),(0,a.jsx)("button",{onClick:()=>b(!m),className:"button",children:m?"Hide Settings":"âš™ï¸ Analytics Settings"})]}),m&&!p&&(0,a.jsx)("form",{onSubmit:async e=>{e.preventDefault(),x(!0),y(""),k({});try{(await c("analytics",n)).success&&(y("Analytics settings saved successfully!"),b(!1))}catch(e){const t=e;t.data?.errors?(k(t.data.errors),y("Validation failed. Please check the fields below.")):y(t.message||"Error saving settings.")}finally{x(!1)}},style:{marginBottom:"20px",padding:"20px",background:"#f5f5f5",borderRadius:"4px"},children:(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"Analytics Configuration"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"enabled",children:[(0,a.jsx)("input",{type:"checkbox",id:"enabled",checked:n.enabled,onChange:e=>s({...n,enabled:e.target.checked})})," ","Enable Analytics Collection"]}),(0,a.jsx)("p",{className:"description",children:"Track chatbot usage and queries"})]}),n.enabled&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"retention_days",children:"Analytics Retention (days)"}),(0,a.jsx)("input",{type:"number",id:"retention_days",value:n.retention_days,onChange:e=>s({...n,retention_days:Number(e.target.value)}),min:"7",max:"365","aria-describedby":"retention_days_desc"}),(0,a.jsx)("p",{className:"description",id:"retention_days_desc",children:"How long to keep analytics data (default: 90 days)"}),j.retention_days&&(0,a.jsx)("p",{className:"error-text",children:j.retention_days})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"anonymize_ip",children:[(0,a.jsx)("input",{type:"checkbox",id:"anonymize_ip",checked:n.anonymize_ip,onChange:e=>s({...n,anonymize_ip:e.target.checked})})," ","Anonymize IP Addresses"]}),(0,a.jsx)("p",{className:"description",children:"Mask IP addresses for GDPR compliance"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"track_feedback",children:[(0,a.jsx)("input",{type:"checkbox",id:"track_feedback",checked:n.track_feedback,onChange:e=>s({...n,track_feedback:e.target.checked})})," ","Track User Feedback"]}),(0,a.jsx)("p",{className:"description",children:"Record thumbs up/down feedback on answers"})]})]}),(0,a.jsx)("div",{className:"form-actions",children:(0,a.jsx)("button",{type:"submit",className:"button button-primary",disabled:h,children:h?"Saving...":"Save Settings"})})]})}),(0,a.jsxs)("div",{className:"analytics-grid",children:[(0,a.jsxs)("div",{className:"analytics-card",children:[(0,a.jsx)("h3",{children:"Overview"}),(0,a.jsxs)("div",{className:"stats-grid",children:[(0,a.jsxs)("div",{className:"stat",children:[(0,a.jsx)("span",{className:"stat-label",children:"Total Queries"}),(0,a.jsx)("span",{className:"stat-value",children:e.total})]}),(0,a.jsxs)("div",{className:"stat",children:[(0,a.jsx)("span",{className:"stat-label",children:"Answered"}),(0,a.jsx)("span",{className:"stat-value success",children:e.answered})]}),(0,a.jsxs)("div",{className:"stat",children:[(0,a.jsx)("span",{className:"stat-label",children:"Unanswered"}),(0,a.jsx)("span",{className:"stat-value warning",children:e.unanswered})]}),(0,a.jsxs)("div",{className:"stat",children:[(0,a.jsx)("span",{className:"stat-label",children:"Success Rate"}),(0,a.jsxs)("span",{className:"stat-value",children:[w,"%"]})]})]})]}),(0,a.jsxs)("div",{className:"analytics-card",children:[(0,a.jsx)("h3",{children:"Top Queries"}),(0,a.jsxs)("table",{className:"analytics-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Query"}),(0,a.jsx)("th",{children:"Count"})]})}),(0,a.jsx)("tbody",{children:e.top_queries.slice(0,10).map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.query}),(0,a.jsx)("td",{children:(0,a.jsx)("strong",{children:e.count})})]},t))})]})]}),(0,a.jsxs)("div",{className:"analytics-card",children:[(0,a.jsx)("h3",{children:"Unanswered Queries"}),(0,a.jsxs)("table",{className:"analytics-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Query"}),(0,a.jsx)("th",{children:"Count"})]})}),(0,a.jsx)("tbody",{children:e.unanswered_queries.slice(0,10).map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.query}),(0,a.jsx)("td",{children:(0,a.jsx)("strong",{children:e.count})})]},t))})]}),0===e.unanswered_queries.length&&(0,a.jsx)("p",{className:"no-data",children:"No unanswered queries in this period"})]}),(0,a.jsxs)("div",{className:"analytics-card full-width",children:[(0,a.jsx)("h3",{children:"Query Trends"}),(0,a.jsx)("div",{className:"trend-chart",children:e.trends.map((t,n)=>{const r=Math.max(...e.trends.map(e=>e.count)),s=r>0?t.count/r*100:0;return(0,a.jsxs)("div",{className:"trend-bar-container",children:[(0,a.jsx)("div",{className:"trend-bar",style:{height:`${s}%`},title:`${t.date}: ${t.count} queries`}),(0,a.jsx)("span",{className:"trend-label",children:t.date.substring(5)})]},n)})})]})]})]})},f=()=>{const[e,t]=(0,r.useState)("overview"),[n,s]=(0,r.useState)(null),[i,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{"analytics"===e&&l()},[e]);const l=async()=>{if(null===n){o(!0);try{const e=await fetch(`${kraftAIChatAdmin.apiUrl}/analytics/summary?days=7`,{headers:{"X-WP-Nonce":kraftAIChatAdmin.nonce}}),t=await e.json();s(t)}catch(e){console.error("Failed to fetch analytics:",e)}finally{o(!1)}}};return(0,a.jsxs)("div",{className:"ki-kraft-dashboard",children:[(0,a.jsxs)("nav",{className:"dashboard-nav",children:[(0,a.jsx)("button",{className:"overview"===e?"active":"",onClick:()=>t("overview"),children:"Overview"}),(0,a.jsx)("button",{className:"knowledge"===e?"active":"",onClick:()=>t("knowledge"),children:"Knowledge Base"}),(0,a.jsx)("button",{className:"analytics"===e?"active":"",onClick:()=>t("analytics"),children:"Analytics"}),(0,a.jsx)("button",{className:"privacy"===e?"active":"",onClick:()=>t("privacy"),children:"Privacy"}),(0,a.jsx)("button",{className:"branding"===e?"active":"",onClick:()=>t("branding"),children:"Branding"})]}),(0,a.jsx)("div",{className:"dashboard-content",children:(()=>{switch(e){case"overview":return(0,a.jsxs)("div",{className:"dashboard-overview",children:[(0,a.jsx)("h1",{children:"KI Kraft Dashboard"}),(0,a.jsxs)("div",{className:"dashboard-grid",children:[(0,a.jsxs)("div",{className:"dashboard-card",children:[(0,a.jsx)("h2",{children:"Welcome to Kraft AI Chat"}),(0,a.jsx)("p",{children:"Use the tabs above to manage your chatbot, knowledge base, analytics, privacy settings, and branding."}),(0,a.jsxs)("div",{className:"action-buttons",style:{marginTop:"20px"},children:[(0,a.jsx)("button",{onClick:()=>t("knowledge"),className:"action-btn",children:"ðŸ“š Manage Knowledge Base"}),(0,a.jsx)("button",{onClick:()=>t("analytics"),className:"action-btn",children:"ðŸ“Š View Analytics"}),(0,a.jsx)("button",{onClick:()=>t("privacy"),className:"action-btn",children:"ðŸ”’ Privacy Settings"}),(0,a.jsx)("button",{onClick:()=>t("branding"),className:"action-btn",children:"ðŸŽ¨ Customize Branding"})]})]}),(0,a.jsxs)("div",{className:"dashboard-card",children:[(0,a.jsx)("h2",{children:"Getting Started"}),(0,a.jsxs)("ol",{children:[(0,a.jsx)("li",{children:"Add knowledge entries in the Knowledge Base tab"}),(0,a.jsx)("li",{children:"Configure privacy and data retention settings"}),(0,a.jsx)("li",{children:"Customize branding to match your site"}),(0,a.jsx)("li",{children:"Monitor usage in the Analytics tab"})]})]})]})]});case"privacy":return(0,a.jsx)(x,{});case"branding":return(0,a.jsx)(m,{});case"knowledge":return(0,a.jsx)(b,{});case"analytics":return(0,a.jsx)(g,{});default:return(0,a.jsx)("div",{children:"Unknown tab"})}})()})]})},v=()=>{const[e,t]=(0,r.useState)({site_enabled:!0,default_lang:"de",cache_enabled:!0,cache_ttl:86400,rate_limit_enabled:!0,rate_limit_max:60,rate_limit_window:3600}),[n,s]=(0,r.useState)(!0),[i,o]=(0,r.useState)(!1),[d,p]=(0,r.useState)(""),[u,h]=(0,r.useState)({});(0,r.useEffect)(()=>{x()},[]);const x=async()=>{try{const e=await l("general");t(e)}catch(e){console.error("Failed to load settings:",e),p("Failed to load settings.")}finally{s(!1)}};return n?(0,a.jsx)("div",{className:"settings-tab general-tab",children:(0,a.jsx)("p",{children:"Loading settings..."})}):(0,a.jsxs)("div",{className:"settings-tab general-tab",children:[(0,a.jsx)("h2",{children:"General Settings"}),(0,a.jsx)("p",{children:"Configure general plugin behavior and performance settings."}),d&&(0,a.jsx)("div",{className:"notice "+(d.includes("successfully")?"notice-success":"notice-error"),role:"status","aria-live":"polite",children:(0,a.jsx)("p",{children:d})}),(0,a.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),o(!0),p(""),h({});try{(await c("general",e)).success&&p("Settings saved successfully!")}catch(e){const t=e;t.data?.errors?(h(t.data.errors),p("Validation failed. Please check the fields below.")):p(t.message||"Error saving settings.")}finally{o(!1)}},children:[(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"Site Settings"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"site_enabled",children:[(0,a.jsx)("input",{type:"checkbox",id:"site_enabled",checked:e.site_enabled,onChange:n=>t({...e,site_enabled:n.target.checked})})," ","Enable Plugin Site-Wide"]}),(0,a.jsx)("p",{className:"description",children:"Activate the chatbot functionality across the entire site"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"default_lang",children:"Default Language"}),(0,a.jsxs)("select",{id:"default_lang",value:e.default_lang,onChange:n=>t({...e,default_lang:n.target.value}),children:[(0,a.jsx)("option",{value:"de",children:"Deutsch (German)"}),(0,a.jsx)("option",{value:"en",children:"English"}),(0,a.jsx)("option",{value:"fr",children:"FranÃ§ais (French)"}),(0,a.jsx)("option",{value:"es",children:"EspaÃ±ol (Spanish)"}),(0,a.jsx)("option",{value:"it",children:"Italiano (Italian)"})]}),(0,a.jsx)("p",{className:"description",children:"Primary language for chatbot responses"}),u.default_lang&&(0,a.jsx)("p",{className:"error-text",children:u.default_lang})]})]}),(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"Caching"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"cache_enabled",children:[(0,a.jsx)("input",{type:"checkbox",id:"cache_enabled",checked:e.cache_enabled,onChange:n=>t({...e,cache_enabled:n.target.checked})})," ","Enable Query Caching"]}),(0,a.jsx)("p",{className:"description",children:"Cache frequent queries to improve performance"})]}),e.cache_enabled&&(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"cache_ttl",children:"Cache TTL (seconds)"}),(0,a.jsx)("input",{type:"number",id:"cache_ttl",value:e.cache_ttl,onChange:n=>t({...e,cache_ttl:Number(n.target.value)}),min:"60",max:"604800"}),(0,a.jsx)("p",{className:"description",children:"How long to cache results (default: 86400 = 24 hours)"}),u.cache_ttl&&(0,a.jsx)("p",{className:"error-text",children:u.cache_ttl})]})]}),(0,a.jsxs)("div",{className:"form-section",children:[(0,a.jsx)("h3",{children:"Rate Limiting"}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsxs)("label",{htmlFor:"rate_limit_enabled",children:[(0,a.jsx)("input",{type:"checkbox",id:"rate_limit_enabled",checked:e.rate_limit_enabled,onChange:n=>t({...e,rate_limit_enabled:n.target.checked})})," ","Enable Rate Limiting"]}),(0,a.jsx)("p",{className:"description",children:"Prevent abuse by limiting query frequency"})]}),e.rate_limit_enabled&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"rate_limit_max",children:"Maximum Requests"}),(0,a.jsx)("input",{type:"number",id:"rate_limit_max",value:e.rate_limit_max,onChange:n=>t({...e,rate_limit_max:Number(n.target.value)}),min:"10",max:"1000"}),(0,a.jsx)("p",{className:"description",children:"Maximum number of requests per time window"}),u.rate_limit_max&&(0,a.jsx)("p",{className:"error-text",children:u.rate_limit_max})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"rate_limit_window",children:"Time Window (seconds)"}),(0,a.jsx)("input",{type:"number",id:"rate_limit_window",value:e.rate_limit_window,onChange:n=>t({...e,rate_limit_window:Number(n.target.value)}),min:"60",max:"86400"}),(0,a.jsx)("p",{className:"description",children:"Time window for rate limiting (default: 3600 = 1 hour)"}),u.rate_limit_window&&(0,a.jsx)("p",{className:"error-text",children:u.rate_limit_window})]})]})]}),(0,a.jsx)("div",{className:"form-actions",children:(0,a.jsx)("button",{type:"submit",className:"button button-primary",disabled:i||n,children:i?"Saving...":"Save Settings"})})]})]})},y=()=>{const[e,t]=(0,r.useState)("general"),[n,s]=(0,r.useState)(""),i=[{id:"general",label:"General Settings",icon:"âš™ï¸"},{id:"privacy",label:"Privacy",icon:"ðŸ”’"},{id:"branding",label:"Branding",icon:"ðŸŽ¨"},{id:"knowledge",label:"Knowledge Defaults",icon:"ðŸ“š"},{id:"analytics",label:"Analytics",icon:"ðŸ“Š"}].filter(e=>e.label.toLowerCase().includes(n.toLowerCase()));return(0,a.jsxs)("div",{className:"ki-kraft-settings-page",children:[(0,a.jsxs)("div",{className:"settings-header",children:[(0,a.jsx)("h1",{children:"Kraft AI Chat Settings"}),(0,a.jsx)("p",{children:"Configure all aspects of your chatbot plugin."})]}),(0,a.jsx)("div",{className:"settings-search",children:(0,a.jsx)("input",{type:"text",placeholder:"Search settings...",value:n,onChange:e=>s(e.target.value),className:"settings-search-input","aria-label":"Search settings"})}),(0,a.jsxs)("div",{className:"settings-layout",children:[(0,a.jsx)("nav",{className:"settings-sidebar",role:"navigation","aria-label":"Settings sections",children:i.map(n=>(0,a.jsxs)("button",{className:e===n.id?"active":"",onClick:()=>t(n.id),"aria-current":e===n.id?"page":void 0,children:[(0,a.jsx)("span",{className:"icon",children:n.icon}),(0,a.jsx)("span",{className:"label",children:n.label})]},n.id))}),(0,a.jsx)("main",{className:"settings-content",role:"main",children:(()=>{switch(e){case"general":return(0,a.jsx)(v,{});case"privacy":return(0,a.jsx)(x,{});case"branding":return(0,a.jsx)(m,{});case"knowledge":return(0,a.jsx)(b,{});case"analytics":return(0,a.jsx)(g,{});default:return(0,a.jsx)("div",{children:"Unknown section"})}})()})]}),(0,a.jsx)("footer",{className:"settings-footer",children:(0,a.jsxs)("div",{className:"disclaimer",children:[(0,a.jsx)("h3",{children:"âš ï¸ Disclaimer"}),(0,a.jsx)("p",{children:"This plugin uses AI technology to generate responses. While we strive for accuracy, AI-generated content should be reviewed and verified. The plugin does not guarantee the correctness of responses. Use at your own discretion."}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Data Privacy:"})," No telemetry data is collected without explicit opt-in. Please review the Privacy settings to ensure compliance with applicable data protection laws."]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("a",{href:kraftAIChatAdmin.branding?.privacy_url||"#",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})," | ",(0,a.jsx)("a",{href:kraftAIChatAdmin.branding?.imprint_url||"#",target:"_blank",rel:"noopener noreferrer",children:"Imprint"})]})]})})]})};var j=n(72),k=n.n(j),_=n(825),N=n.n(_),w=n(659),S=n.n(w),C=n(56),A=n.n(C),F=n(540),P=n.n(F),E=n(113),I=n.n(E),R=n(409),D={};D.styleTagTransform=I(),D.setAttributes=A(),D.insert=S().bind(null,"head"),D.domAPI=N(),D.insertStyleElement=P(),k()(R.A,D),R.A&&R.A.locals&&R.A.locals;const L=document.getElementById("ki-kraft-admin-root");if(L){const e=(0,i.H)(L),t="kraft-ai-chat-settings"===kraftAIChatAdmin.page;e.render((0,a.jsx)(s().StrictMode,{children:t?(0,a.jsx)(y,{}):(0,a.jsx)(f,{})}))}})();